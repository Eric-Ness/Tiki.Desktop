---
type: prompt
name: tiki:knowledge
description: Manage institutional knowledge entries. Use to capture, search, and view learnings from past issues.
allowed-tools: Read, Write, Edit, Glob, Grep, AskUserQuestion
argument-hint: add "title" | edit <id> | show <id> | list | search <query> | archive <id>
---

# Knowledge

Manage institutional knowledge entries - capture learnings from issues, debugging sessions, and project patterns.

## Usage

```
/tiki:knowledge add "How to handle rate limiting"
/tiki:knowledge edit K001
/tiki:knowledge show K001
/tiki:knowledge list
/tiki:knowledge search "authentication"
/tiki:knowledge archive K001
```

## Instructions

### Step 1: Parse Command

Determine the action from input:

| Command | Action |
|---------|--------|
| `add "title"` | Create new entry interactively |
| `edit K###` | Edit existing entry |
| `show K###` | Display entry content |
| `list` | List recent entries (20 max) |
| `search <query>` | Search by keyword |
| `archive K###` | Archive an entry |
| (no args) | Show usage |

### Step 2: Initialize Storage

Check for knowledge storage directory and index:

```
.tiki/knowledge/
├── index.json          # Entry index with metadata
└── entries/            # Individual entry files
    ├── K001.json
    └── K002.json
```

**If storage doesn't exist:**
1. Create `.tiki/knowledge/` directory
2. Create `.tiki/knowledge/entries/` directory
3. Initialize `.tiki/knowledge/index.json`:
```json
{
  "lastUpdated": "{ISO timestamp}",
  "nextId": 1,
  "entries": {}
}
```

### Step 3: Execute Action

**For `add`:**
Read `.tiki/prompts/knowledge/add-entry.md` and follow the interactive creation workflow.

**For `edit`:**
1. Read the entry from `.tiki/knowledge/entries/{id}.json`
2. Display current content
3. Ask what to change (title, content, keywords, confidence, related)
4. Update file and index with new `updated` timestamp

**For `show`:**
1. Read entry from `.tiki/knowledge/entries/{id}.json`
2. Display formatted:
```
## K001: {Title}

**Source:** {type} {details} | **Confidence:** {level} | **Created:** {date}

{content}

**Keywords:** {keyword1}, {keyword2}, ...

**Related:**
- Issues: #{N}, #{M}
- Files: {path1}, {path2}
- ADRs: ADR-{NNN}
```

**For `list`:**
1. Read `.tiki/knowledge/index.json`
2. Filter out archived entries (unless `--all` flag)
3. Sort by created date (newest first)
4. Display table:
```
## Knowledge Entries

| ID   | Title                          | Source    | Confidence | Created    |
|------|--------------------------------|-----------|------------|------------|
| K001 | How to handle rate limiting    | issue #42 | high       | 2026-01-15 |
| K002 | Debug memory leak pattern      | debug     | medium     | 2026-01-14 |

Showing 2 of 2 entries. Use `search <query>` to filter.
```

**For `search`:**
Read `.tiki/prompts/knowledge/search-display.md` and follow the search workflow.

**For `archive`:**
1. Read entry from `.tiki/knowledge/entries/{id}.json`
2. Set `archived: true` and `archivedAt: {ISO timestamp}`
3. Update entry file and index
4. Confirm: `Archived K{NNN}: {title}`

## Notes

- Knowledge stored in `.tiki/knowledge/`
- Entries are JSON files with full content
- Index provides quick lookup by ID and keywords
- Auto-generated entries marked with `autoGenerated: true`
- Archived entries hidden from list by default
- Invalid entry IDs (non-existent K###) display error: "Entry {id} not found"
- List shows max 20 entries; use search to find specific entries
