# Knowledge Entry Creation Workflow

## Step 1: Gather Information

Ask for details if not provided:

```
## New Knowledge Entry: {Title}

I'll help capture this knowledge. Please provide:

1. **Content**: What is the key insight or learning?
2. **Context**: When/where did you learn this? (issue, debugging, general experience)
3. **Related files**: Any specific files in the codebase this applies to?
```

Or if context is clear from recent work:

```
Based on our recent work on issue #{N}, I'll capture this knowledge:

**Title:** {Title}
**Content:** {Draft content based on context}
**Keywords:** {auto-generated keywords}
**Confidence:** {high/medium/low based on evidence}

Does this look right? [Edit/Accept]
```

## Step 2: Generate Keywords

Auto-generate keywords from:
1. Title words (excluding common words: the, a, an, to, for, in, on, etc.)
2. Key terms from content
3. Related file paths (extract technology/pattern names)
4. Source information (issue labels, debug patterns)

Suggest 5-10 keywords, ask user to confirm or adjust.

## Step 3: Determine Confidence

Guide confidence selection:

| Level | Criteria |
|-------|----------|
| high | Verified through implementation, documented in official sources, or repeatedly confirmed |
| medium | Based on successful implementation but limited testing, or from reputable but unofficial sources |
| low | Theoretical, untested, or based on limited experience |

## Step 4: Build Related References

Ask about related items:

```
**Related References (optional):**
- Issue numbers? (e.g., 42, 56)
- ADR numbers? (e.g., 001, 002)
- File paths? (e.g., src/utils/auth.ts)
- Other knowledge entries? (e.g., K001, K003)
```

## Step 5: Create Entry

Read `.tiki/knowledge/index.json` to get nextId.

Create entry file at `.tiki/knowledge/entries/K{NNN}.json`:

```json
{
  "id": "K{NNN}",
  "title": "{title}",
  "content": "{markdown content}",
  "created": "{ISO timestamp}",
  "source": {
    "type": "{manual|issue|debug-session|execution}",
    "issueNumber": {N},
    "issueTitle": "{title}"
  },
  "keywords": ["{keyword1}", "{keyword2}"],
  "related": {
    "issues": [{N}],
    "adrs": ["{NNN}"],
    "files": ["{path}"],
    "knowledge": ["{K###}"]
  },
  "confidence": "{high|medium|low}",
  "autoGenerated": false
}
```

## Step 6: Update Index

Update `.tiki/knowledge/index.json`:

```json
{
  "lastUpdated": "{ISO timestamp}",
  "nextId": {N+1},
  "entries": {
    "K{NNN}": {
      "title": "{title}",
      "created": "{ISO timestamp}",
      "source": "{type}",
      "keywords": ["{keywords}"],
      "files": ["{paths}"],
      "confidence": "{level}",
      "autoGenerated": false
    }
  }
}
```

## Step 7: Confirm Creation

```
## Knowledge Captured

Created: K{NNN} - {title}
Source: {type} | Confidence: {level}
Keywords: {keyword1}, {keyword2}, ...

View: /tiki:knowledge show K{NNN}
List: /tiki:knowledge list
```
